"use strict";function e(e){var n,i;if("string"==typeof e&&(n=r.exec(e))&&(i=t.exec(function(e){return""+o.from(e,"base64")}(n[1]))))return new function(e,r){this.name=e,this.pass=r}(i[1],i[2])}var r,t,o=require("safe-buffer").Buffer;module.exports=function(r){if(!r)throw new TypeError("argument req is required");if("object"!=typeof r)throw new TypeError("argument req is required to be an object");return e(function(e){if(!e.headers||"object"!=typeof e.headers)throw new TypeError("argument req is required to have headers property");return e.headers.authorization}(r))},module.exports.parse=e,r=/^ *(?:[Bb][Aa][Ss][Ii][Cc]) +([A-Za-z0-9._~+/-]+=*) *$/,t=/^([^:]*):(.*)$/;